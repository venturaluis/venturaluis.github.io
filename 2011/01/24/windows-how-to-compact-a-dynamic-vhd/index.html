<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Windows: How To Compact A Dynamic VHD | Linhost.info</title><meta name="description" content="Windows: How To Compact A Dynamic VHD - Moody Gent"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="Linhost.info"><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="Linhost.info" type="application/atom+xml">
</head><body><div class="wrap"><header><h1 class="branding"><a href="/" title="Linhost.info">Linhost.info</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/Dreyer" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about" target="_self">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Windows: How To Compact A Dynamic VHD</h1><div class="post-info"><a></a>2011-01-24</div><div class="post-content"><p>Making use of dynaminc VHDs or Virtual Hard Disks has the benefit of growing along with the users need. The downside is that even after files are deleted from a dynamic VHD it will remain the same size as if the files where never deleted. <img src="http://lh3.ggpht.com/_fF0LO28FGYY/TT0-dwJmSkI/AAAAAAAAC5o/nuUZUMXA02Q/s800/Windows_generic_h_web.jpg" title="Windows"> This becomes a problem if you make use of multiple VHDs because you are essentially wasting space on files that no longer exist. The solution is to Compact the VHD using <a target="_blank" rel="noopener" href="http://support.microsoft.com/kb/300415">Diskpart</a> a tool provided with Windows.</p>
<h3 id="Start-Compacting"><a href="#Start-Compacting" class="headerlink" title="Start Compacting"></a>Start Compacting</h3><p>Open a command line window and type:</p>
<p>diskpart</p>
<p>Select the disk you wish to compact by specifying the drive where the file is located and the path:</p>
<p>select vdisk file=”F:DAT100GB.vhd”</p>
<p>Attach the disk as <strong>Read-only</strong>:</p>
<p>attach vdisk readonly</p>
<p>And issue the command to compact:</p>
<p>compact vdisk</p>
<p><em>Depending on the size of the drive the operation may take some.</em> <img src="http://lh5.ggpht.com/_fF0LO28FGYY/TT09oRqy1EI/AAAAAAAAC5k/LtTsXbpw-hU/s800/vhd-vdisk.png"> Detach the VHD:</p>
<p>detach vdisk</p>
<p>In my case after compacting a 100GB VHD with 20GB of deleted data the size decreased to 82.2MB, Dynamic VHDs are useful but can also become the reason why disk space is low. If you have any questions leave a comment below.</p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2011/02/01/10-portable-applications-to-consider-part-1/">prev</a><a class="next" href="/2011/01/23/freenas-phydiskwrite-freenas-embedded-install-using-windows/">next</a></div><div class="copyright"><p>&copy; 2016 - 2020 <a target="_blank" rel="noopener" href="https://www.example.org/john-doe">John Doe</a>.<br>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/Dreyer/hexo-theme-artemis" target="_blank">Artemis</a>.</p></div></footer></div><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-12345678-9']);
_gaq.push(['_trackPageview']);

(function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script></body></html>