<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Windows: How To Compact A Dynamic VHD | Linhost.info</title>
  
  
  <meta name="description" content="site, site">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="generator" content="Hexo 2.6.0"/>

  <meta property="og:title" content="Windows: How To Compact A Dynamic VHD"/>
  <meta property="og:site_name" content="Linhost.info"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.png" rel="shortcut icon">

  
    <link rel="stylesheet" href="/css/highlightjs/github.css">
  
  <script src="/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="alternate" href="/atom.xml" title="Linhost.info" type="application/atom+xml">

  <link href="/css/site.css" rel="stylesheet">
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <script type="text/javascript" src="/js/jquery.caption.min.js"></script>
  <link href="/css/captionjs.min.css" rel="stylesheet"/>
  <script type="text/javascript" src="/js/ewal.js"></script>

  
  




</head>

<body>
  

<div class="navbar navbar-default navbar-static-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><span class="text-primary">Linhost.info</span></a>
    </div>
    <div class="collapse navbar-collapse navbar-right">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav pull-right">
      
      
      
      
      </ul>
    </div>
  </div>
</div>


  <div class="container">
    <div class="row">
      <div><article class="post">
  
    
  
    <h1 class="title">Windows: How To Compact A Dynamic VHD</h1>
  

    <div class="post-date">
      <time datetime="2011-01-24T09:25:08.000Z">2011-01-24</time>
    </div>
  
  <div class="post-content">
    
      <p>Making use of dynaminc VHDs or Virtual Hard Disks has the benefit of growing along with the users need. The downside is that even after files are deleted from a dynamic VHD it will remain the same size as if the files where never deleted. <img src="http://lh3.ggpht.com/_fF0LO28FGYY/TT0-dwJmSkI/AAAAAAAAC5o/nuUZUMXA02Q/s800/Windows_generic_h_web.jpg" title="Windows"> This becomes a problem if you make use of multiple VHDs because you are essentially wasting space on files that no longer exist. The solution is to Compact the VHD using <a target="_blank" rel="noopener" href="http://support.microsoft.com/kb/300415">Diskpart</a> a tool provided with Windows.</p>
<h3 id="Start-Compacting"><a href="#Start-Compacting" class="headerlink" title="Start Compacting"></a>Start Compacting</h3><p>Open a command line window and type:</p>
<p>diskpart</p>
<p>Select the disk you wish to compact by specifying the drive where the file is located and the path:</p>
<p>select vdisk file=”F:DAT100GB.vhd”</p>
<p>Attach the disk as <strong>Read-only</strong>:</p>
<p>attach vdisk readonly</p>
<p>And issue the command to compact:</p>
<p>compact vdisk</p>
<p><em>Depending on the size of the drive the operation may take some.</em> <img src="http://lh5.ggpht.com/_fF0LO28FGYY/TT09oRqy1EI/AAAAAAAAC5k/LtTsXbpw-hU/s800/vhd-vdisk.png"> Detach the VHD:</p>
<p>detach vdisk</p>
<p>In my case after compacting a 100GB VHD with 20GB of deleted data the size decreased to 82.2MB, Dynamic VHDs are useful but can also become the reason why disk space is low. If you have any questions leave a comment below.</p>

    
  </div>
  
    
  
  <div class="categories">
    <a href="/categories/Article/">Article</a>
  </div>


    
  
  <div class="tags">
    <a href="/tags/windows/">windows</a>, <a href="/tags/vhd/">vhd</a>, <a href="/tags/diskpart/">diskpart</a>
  </div>

  
  <div class="addthis_toolbox addthis_default_style 
addthis_32x32_style" data-addthis-url="http://linhost.info/2011/01/windows-how-to-compact-a-dynamic-vhd/" data-addthis-title="Windows: How To Compact A Dynamic VHD">
<a class="addthis_button_preferred_1"></a>
<a class="addthis_button_preferred_2"></a>
<a class="addthis_button_preferred_3"></a>
<a class="addthis_button_preferred_4"></a>
<a class="addthis_button_compact"></a>
<a class="addthis_counter addthis_bubble_style"></a>
</div>
  
    <ul class="next_prev">
      
        <li class="prev">
        <a class="btn btn-success" role="button" href="/2011/01/freenas-phydiskwrite-freenas-embedded-install-using-windows/">
          Previous
        </a></li>
      
      
        <li class="next">
        <a class="btn btn-success" role="button" href="/2011/02/10-portable-applications-to-consider-part-1/">
          Next
        </a></li>
      
    </ul>
  
  

</article>
</div>
    </div>
  </div>
  <div id="push"></div>
  <div class="navbar navbar-footer">
  <div class="container">
    <p class="navbar-center navbar-text">
      
      &copy; 2020 Linhost.info
      
    </p>
  </div>
</div>
  <script src="/js/bootstrap.min.js"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3282416-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>






</body>
</html>