<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.1.1" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.1.1" type="image/png" sizes="32x32"><meta name="description" content="At home I have a pfSense firewall, the thing about my firewall is that I did a full installation on a Compact Flash card. Because, I want the benefits of a full installation like not loosing RRD graph">
<meta property="og:type" content="article">
<meta property="og:title" content="Check a Drive For Bad Sectors with Badblocks">
<meta property="og:url" content="http://linhost.info/2010/09/check-a-drive-for-bad-sectors-with-badblocks/index.html">
<meta property="og:site_name" content="Linhost.info">
<meta property="og:description" content="At home I have a pfSense firewall, the thing about my firewall is that I did a full installation on a Compact Flash card. Because, I want the benefits of a full installation like not loosing RRD graph">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://lh4.ggpht.com/_fF0LO28FGYY/TJVgkV3hR7I/AAAAAAAACgQ/ksAx-RunEnk/s800/badblocks_parameter.png">
<meta property="article:published_time" content="2010-09-20T07:01:40.000Z">
<meta property="article:modified_time" content="2020-08-09T09:07:53.711Z">
<meta property="article:author" content="Lven">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="badblocks">
<meta property="article:tag" content="compact flash">
<meta property="article:tag" content="flash memory">
<meta property="article:tag" content="hard drives">
<meta property="article:tag" content="parted magic">
<meta property="article:tag" content="sectors">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://lh4.ggpht.com/_fF0LO28FGYY/TJVgkV3hR7I/AAAAAAAACgQ/ksAx-RunEnk/s800/badblocks_parameter.png"><title>Check a Drive For Bad Sectors with Badblocks | Linhost.info</title><link ref="canonical" href="http://linhost.info/2010/09/check-a-drive-for-bad-sectors-with-badblocks/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.1.1"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><script src="https://www.googletagmanager.com/gtag/js?id=UA-3282416-1" async=""></script><script>if (window.location.hostname !== 'localhost') {
  window.dataLayer = window.dataLayer || [];
  function gtag(){ dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'UA-3282416-1');
}</script><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: undefined,
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="Linhost.info" type="application/atom+xml">
</head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__text">menu.Home</span></a></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Linhost.info</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Check a Drive For Bad Sectors with Badblocks</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2010-09-20</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2020-08-09</span></span></div></header><div class="post-body"><p>At home I have a pfSense firewall, the thing about my firewall is that I did a full installation on a Compact Flash card. Because, I want the benefits of a full installation like not loosing RRD graphs in case someone accidentally pulls the plug. The downside of using Compact Flash cards or Flash memory is the finite number of writes before wearing down and resulting in damaged sectors (unusable ones). The advantages of Flash memory are: <em>no moving parts, creates little heat, low power, and no noise</em>. This is why Flash memory is ideal for my needs, and I know of other full installs on Compact Flash cards that have worked for up to three years and even longer. <strong>You can take some precautions to reduce wear on a Compact Flash like:</strong></p>
<ul>
<li>Use the embedded version of pfSense</li>
<li>With enough RAM the system may not have to use the swap partition at all.</li>
<li>Remove the swap partition.</li>
</ul>
<p>And it doens’t hurt to know that SLC Flash will last longer than MLC Flash.</p>
<blockquote>
<p>Flash Cell Endurance: For Multi-Level Cell (MLC) Flash, up to 10,000 write cycles per physical sector. For Single-Level Cell (SLC) Flash, up to 100,000 write cycles per physical sector.</p>
</blockquote>
<p>Source: <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://www.kingston.com/flash_memory_guide/" >Kingston Flash Memory Guide</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> Because, I have 512MB of RAM in my Firewall which is more than enough, I did not remove the swap partition. Still, I worry about the finite number of writes on Flash memory, which prompted me to use badblocks. Badblocks is a tool capable of scanning a drive and report back on any damaged sectors it encounters. Modern drives can handle damaged sectors by seamlessly ignoring damaged sectors and only working with the remaining good sectors. This may sound great at first, but the truth is that the card is in the process of deteriorating(more to come) and the drive may need to be replaced.</p>

        <h2 id="Tools-of-the-trade"   >
          <a href="#Tools-of-the-trade" class="heading-link"><i class="fas fa-link"></i></a>Tools of the trade</h2>
      <p>For this tutorial I will be using <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://partedmagic.com/" >Parted Magic</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> a Live distribution which includes badblocks. However, you will find badblocks on any Linux distributions. Also, make sure the target drive is unmounted before running badblocks. First you need the name of the drive you wish to scan, for this we can use <strong>lshw</strong> or Hardware Lister. The command is <strong>lshw -C disk</strong>.</p>
<p>root@PartedMagic:~# lshw -C disk<br>  *-disk<br>       description: ATA Disk<br>       product: ELITE PRO CF CAR<br>       physical id: 0.0.0<br>       bus info: scsi@2:0.0.0<br>       logical name: /dev/sda<br>       version: Ver3<br>       serial: 5B021A040<br>       size: 3639MiB (3816MB)<br>       capabilities: partitioned partitioned:dos<br>       configuration: ansiversion=5 signature=8f800000<br>  *-cdrom<br>       description: DVD reader<br>       physical id: 0.1.0<br>       bus info: scsi@3:0.1.0<br>       logical name: /dev/scd0<br>       logical name: /dev/sr0<br>       capabilities: audio dvd<br>       configuration: status=nodisc<br>  *-disk<br>       description: SCSI Disk<br>       physical id: 0.0.0<br>       bus info: scsi@4:0.0.0<br>       logical name: /dev/sdb<br>       size: 492MiB (515MB)<br>       capabilities: partitioned partitioned:dos<br>       configuration: signature=795b8ead</p>
<p>Fortunately, the Compact Flash card I am using provides more than enough information about its location <strong>/dev/sda</strong>. With that information in mind we can continue to the second step of this tutorial.</p>

        <h2 id="Let’s-search-for-bad-blocks"   >
          <a href="#Let’s-search-for-bad-blocks" class="heading-link"><i class="fas fa-link"></i></a>Let’s search for bad blocks</h2>
      <p>The command is very simple to understand <strong>badblocks -options /target_drive</strong>. The graphic below should help explain the meaning of the parameters. <a target="_blank" rel="noopener" href="http://picasaweb.google.com/lh/photo/vWirLxtJ6mH2DrMIOJ3cRA?feat=embedwebsite"><img src="http://lh4.ggpht.com/_fF0LO28FGYY/TJVgkV3hR7I/AAAAAAAACgQ/ksAx-RunEnk/s800/badblocks_parameter.png"></a></p>

        <h2 id="Result"   >
          <a href="#Result" class="heading-link"><i class="fas fa-link"></i></a>Result</h2>
      <p>From the output below you can see that badblocks checks every block from 0 all the way to 3727079.</p>
<p>root@PartedMagic:~# badblocks -nvs /dev/sda<br>Checking for bad blocks in non-destructive read-write mode<br>From block 0 to 3727079<br>Checking for bad blocks (non-destructive read-write test)<br>Testing with random pattern: done<br>Pass completed, 0 bad blocks found.</p>
<p>After three months of use my 4GB Kingston Compact Flash card is performing like expected with zero bad blocks. If you plan on doing a full installation on a Compact Flash then you should use badblocks to monitor the health of the Compact Flash over time. Remember to unmount the drive you wish to scan with badblocks.</p>

        <h2 id="Video"   >
          <a href="#Video" class="heading-link"><i class="fas fa-link"></i></a>Video</h2>
      <p>I also made a video of the process. </p>

        <h2 id="Links"   >
          <a href="#Links" class="heading-link"><i class="fas fa-link"></i></a>Links</h2>
      <p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://partedmagic.com/" >Parted Magic Home Page</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://smartmontools.sourceforge.net/badblockhowto.html" >Badblocks</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="http://ezix.org/project/wiki/HardwareLiSter" >lshw</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="http://linhost.info">Lven</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="http://linhost.info/2010/09/check-a-drive-for-bad-sectors-with-badblocks/">http://linhost.info/2010/09/check-a-drive-for-bad-sectors-with-badblocks/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/linux/">linux</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/badblocks/">badblocks</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/compact-flash/">compact flash</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/flash-memory/">flash memory</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/hard-drives/">hard drives</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/parted-magic/">parted magic</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="http://linhost.info/tags/sectors/">sectors</a></span></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/2010/09/microsoft-security-essentials-now-free-for-small-businesses/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">Microsoft Security Essentials Now Free For Small Businesses</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/2010/09/teracopy-improve-file-copying-speeds/"><span class="paginator-prev__text">TeraCopy - Improve File Copying Speeds</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Tools-of-the-trade"><span class="toc-number">1.</span> <span class="toc-text">
          Tools of the trade</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Let%E2%80%99s-search-for-bad-blocks"><span class="toc-number">2.</span> <span class="toc-text">
          Let’s search for bad blocks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Result"><span class="toc-number">3.</span> <span class="toc-text">
          Result</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Video"><span class="toc-number">4.</span> <span class="toc-text">
          Video</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Links"><span class="toc-number">5.</span> <span class="toc-text">
          Links</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">hello world</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">356</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2020</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Lven</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.1.1"></script><script src="/js/stun-boot.js?v=2.1.1"></script><script src="/js/scroll.js?v=2.1.1"></script><script src="/js/header.js?v=2.1.1"></script><script src="/js/sidebar.js?v=2.1.1"></script></body></html>