<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--Description-->
    
        <meta name="description" content="site, site">
    

    <!--Author-->
    
        <meta name="author" content="Moody Gent">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Check a Drive For Bad Sectors with Badblocks"/>
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Linhost.info"/>

    <!--Page Cover-->
    
        <meta property="og:image" content=""/>
    

    <!-- Title -->
    
    <title>Check a Drive For Bad Sectors with Badblocks - Linhost.info</title>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/sass/main.css">


    <!--[if lt IE 8]>
        
<script src="/js/ie/html5shiv.js"></script>

    <![endif]-->

    <!--[if lt IE 8]>
        
<link rel="stylesheet" href="/sass/ie8.css">

    <![endif]-->

    <!--[if lt IE 9]>
        
<link rel="stylesheet" href="/sass/ie9.css">

    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-12345678-9', 'auto');
        ga('send', 'pageview');

    </script>



<meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="Linhost.info" type="application/atom+xml">
</head>

<body>

    <div id="wrapper">

        <!-- Menu -->
        <!-- Header -->
<header id="header">
    <div class="inner">

        <!-- Logo -->
        <a href="/" class="logo">
            <span class="symbol"><img src="/images/logo.svg" alt="" /></span><span class="title">Linhost.info</span>
        </a>

        <!-- Nav -->
        <nav>
            <ul>
                <li><a href="#menu">Menu</a></li>
            </ul>
        </nav>

    </div>
</header>

<!-- Menu -->
<nav id="menu">
    <h2>Menu</h2>
    <ul>
        
            <li>
                <a href="/">Home</a>
            </li>
        
            <li>
                <a href="/archives">Archives</a>
            </li>
        
            <li>
                <a href="/about.html">About</a>
            </li>
        
            <li>
                <a href="/VM">VM</a>
            </li>
        
            <li>
                <a href="/atom.xml">RSS</a>
            </li>
        
    </ul>
</nav>


        <div id="main">
            <div class="inner">

                <!-- Main Content -->
                

    <h1>Check a Drive For Bad Sectors with Badblocks</h1>



<!-- Gallery -->


<!-- Content -->
<p>At home I have a pfSense firewall, the thing about my firewall is that I did a full installation on a Compact Flash card. Because, I want the benefits of a full installation like not loosing RRD graphs in case someone accidentally pulls the plug. The downside of using Compact Flash cards or Flash memory is the finite number of writes before wearing down and resulting in damaged sectors (unusable ones). The advantages of Flash memory are: <em>no moving parts, creates little heat, low power, and no noise</em>. This is why Flash memory is ideal for my needs, and I know of other full installs on Compact Flash cards that have worked for up to three years and even longer. <strong>You can take some precautions to reduce wear on a Compact Flash like:</strong></p>
<ul>
<li>Use the embedded version of pfSense</li>
<li>With enough RAM the system may not have to use the swap partition at all.</li>
<li>Remove the swap partition.</li>
</ul>
<p>And it doens’t hurt to know that SLC Flash will last longer than MLC Flash.</p>
<blockquote>
<p>Flash Cell Endurance: For Multi-Level Cell (MLC) Flash, up to 10,000 write cycles per physical sector. For Single-Level Cell (SLC) Flash, up to 100,000 write cycles per physical sector.</p>
</blockquote>
<p>Source: <a target="_blank" rel="noopener" href="http://www.kingston.com/flash_memory_guide/">Kingston Flash Memory Guide</a> Because, I have 512MB of RAM in my Firewall which is more than enough, I did not remove the swap partition. Still, I worry about the finite number of writes on Flash memory, which prompted me to use badblocks. Badblocks is a tool capable of scanning a drive and report back on any damaged sectors it encounters. Modern drives can handle damaged sectors by seamlessly ignoring damaged sectors and only working with the remaining good sectors. This may sound great at first, but the truth is that the card is in the process of deteriorating(more to come) and the drive may need to be replaced.</p>
<h2 id="Tools-of-the-trade"><a href="#Tools-of-the-trade" class="headerlink" title="Tools of the trade"></a>Tools of the trade</h2><p>For this tutorial I will be using <a target="_blank" rel="noopener" href="http://partedmagic.com/">Parted Magic</a> a Live distribution which includes badblocks. However, you will find badblocks on any Linux distributions. Also, make sure the target drive is unmounted before running badblocks. First you need the name of the drive you wish to scan, for this we can use <strong>lshw</strong> or Hardware Lister. The command is <strong>lshw -C disk</strong>.</p>
<p>root@PartedMagic:~# lshw -C disk<br>  *-disk<br>       description: ATA Disk<br>       product: ELITE PRO CF CAR<br>       physical id: 0.0.0<br>       bus info: scsi@2:0.0.0<br>       logical name: /dev/sda<br>       version: Ver3<br>       serial: 5B021A040<br>       size: 3639MiB (3816MB)<br>       capabilities: partitioned partitioned:dos<br>       configuration: ansiversion=5 signature=8f800000<br>  *-cdrom<br>       description: DVD reader<br>       physical id: 0.1.0<br>       bus info: scsi@3:0.1.0<br>       logical name: /dev/scd0<br>       logical name: /dev/sr0<br>       capabilities: audio dvd<br>       configuration: status=nodisc<br>  *-disk<br>       description: SCSI Disk<br>       physical id: 0.0.0<br>       bus info: scsi@4:0.0.0<br>       logical name: /dev/sdb<br>       size: 492MiB (515MB)<br>       capabilities: partitioned partitioned:dos<br>       configuration: signature=795b8ead</p>
<p>Fortunately, the Compact Flash card I am using provides more than enough information about its location <strong>/dev/sda</strong>. With that information in mind we can continue to the second step of this tutorial.</p>
<h2 id="Let’s-search-for-bad-blocks"><a href="#Let’s-search-for-bad-blocks" class="headerlink" title="Let’s search for bad blocks"></a>Let’s search for bad blocks</h2><p>The command is very simple to understand <strong>badblocks -options /target_drive</strong>. The graphic below should help explain the meaning of the parameters. <a target="_blank" rel="noopener" href="http://picasaweb.google.com/lh/photo/vWirLxtJ6mH2DrMIOJ3cRA?feat=embedwebsite"><img src="http://lh4.ggpht.com/_fF0LO28FGYY/TJVgkV3hR7I/AAAAAAAACgQ/ksAx-RunEnk/s800/badblocks_parameter.png"></a></p>
<h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>From the output below you can see that badblocks checks every block from 0 all the way to 3727079.</p>
<p>root@PartedMagic:~# badblocks -nvs /dev/sda<br>Checking for bad blocks in non-destructive read-write mode<br>From block 0 to 3727079<br>Checking for bad blocks (non-destructive read-write test)<br>Testing with random pattern: done<br>Pass completed, 0 bad blocks found.</p>
<p>After three months of use my 4GB Kingston Compact Flash card is performing like expected with zero bad blocks. If you plan on doing a full installation on a Compact Flash then you should use badblocks to monitor the health of the Compact Flash over time. Remember to unmount the drive you wish to scan with badblocks.</p>
<h2 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h2><p>I also made a video of the process. </p>
<h2 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h2><p><a target="_blank" rel="noopener" href="http://partedmagic.com/">Parted Magic Home Page</a> <a target="_blank" rel="noopener" href="http://smartmontools.sourceforge.net/badblockhowto.html">Badblocks</a> <a target="_blank" rel="noopener" href="http://ezix.org/project/wiki/HardwareLiSter">lshw</a></p>


<!-- Tags -->



<div class="tags">
    <a href="/tags/linux/" class="button small">linux</a> <a href="/tags/badblocks/" class="button small">badblocks</a> <a href="/tags/compact-flash/" class="button small">compact flash</a> <a href="/tags/flash-memory/" class="button small">flash memory</a> <a href="/tags/hard-drives/" class="button small">hard drives</a> <a href="/tags/parted-magic/" class="button small">parted magic</a> <a href="/tags/sectors/" class="button small">sectors</a>
</div>



<!-- Comments -->
<div>
    
    <hr />
    <h3>Comments:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



</div>



            </div>
        </div>

        <!-- Footer -->
<footer id="footer">
    <div class="inner">
        <section>
            <h2>About</h2>
            <div>
                This theme was initially developed by <a href="http://html5up.net" target="_blank">HTML5 UP</a>. It is adapted for Hexo by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a>.<br />The source code is available on <a href="https://github.com/klugjo/hexo-theme-phantom" target="_blank">GitHub</a>.
            </div>
        </section>
        <section>
            <h2>Follow</h2>
            <ul class="icons">
                
                    <li><a href="https://twitter.com/?lang=en" class="icon style2 fa-twitter" target="_blank" ><span class="label">Twitter</span></a></li>
                
                
                    <li><a href="https://www.facebook.com/" class="icon style2 fa-facebook" target="_blank" ><span class="label">Facebook</span></a></li>
                
                
                    <li><a href="https://www.instagram.com/" class="icon style2 fa-instagram" target="_blank" ><span class="label">Instagram</span></a></li>
                
                
                    <li><a href="https://dribbble.com/" class="icon style2 fa-dribbble" target="_blank" ><span class="label">Dribbble</span></a></li>
                
                
                    <li><a href="https://github.com/klugjo/hexo-theme-phantom/commits?author=klugjo" class="icon style2 fa-github" target="_blank" ><span class="label">GitHub</span></a></li>
                
                
                    <li><a href="https://plus.google.com/" class="icon style2 fa-google-plus" target="_blank" ><span class="label">Google+</span></a></li>
                
                
                    <li><a href="https://www.behance.net/" class="icon style2 fa-behance" target="_blank" ><span class="label">Behance</span></a></li>
                
                
                    <li><a href="https://500px.com/" class="icon style2 fa-500px" target="_blank" ><span class="label">500px</span></a></li>
                
                
                    <li><a href="\#" class="icon style2 fa-envelope-o" target="_blank" ><span class="label">Email</span></a></li>
                
                
                    <li><a href="\#" class="icon style2 fa-rss" target="_blank" ><span class="label">RSS</span></a></li>
                
            </ul>
        </section>
        <ul class="copyright">
            <li>&copy; Untitled. All rights reserved</li>
            <li>Design: <a href="http://html5up.net" target="_blank">HTML5 UP</a></li>
            <li>Hexo: <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></li>
        </ul>
    </div>
</footer>
    </div>

    <!-- After footer scripts -->
    
<!-- jQuery -->

<script src="/js/jquery.min.js"></script>


<!-- skel -->

<script src="/js/skel.min.js"></script>


<!-- Custom Code -->

<script src="/js/util.js"></script>


<!--[if lte IE 8]>

<script src="/js/ie/respond.min.js"></script>

<![endif]-->

<!-- Custom Code -->

<script src="/js/main.js"></script>


<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'klugjo';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</body>

</html>